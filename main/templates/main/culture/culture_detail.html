{% extends 'main/base.html' %}
{% block head %}
<title>Culture: {{object.name}}</title>
{% include 'main/location/location-head.html' %}
{% include 'main/timeline/timeline-head.html' %}
{% endblock %}
{% block headline %}<a href="{% url 'culture_list' %}">Culture</a>{% endblock %}

{% block body %}
{% load static %}

<div class='columns'>
    <div class="column col-4" style="position:relative;">
        <a class="btn btn-primary" href="{% url 'culture_update' object.pk %}" style="position:absolute; right:5%; top:10px"><i class="icon icon-edit"></i></a>
        <div class="my-2">
            <h2>{{object.name}} Sites</h2>
            <div style="height: 480px;" id="map"></div><br>
            <h4>Culture</h4>
            <table class="table">
                <thead>
                  <tr>
                    <th>Associated Hominin</th>
                    <th>Parent Culture</th>
                    <th>Children</th>
                    {% if object.ref.first %}
                    <th>References</th>
                    {% endif %}
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>{{object.hominin_group}}</td>
                    <td>
                    {% if object.parent %}
                    <a class='btn-link' href="{% url 'culture_detail' object.parent.pk %}">{{object.parent.name}}</a>
                    {% endif %}
                    </td>
                    <td>
                    {% for child in object.children %}
                    <a class='btn-link' href="{% url 'culture_detail' child.pk %}">{{child.name}}</a><br>
                    {% endfor %}
                    </td>
                    {% if object.ref.first %}
                    <td>
                        {% for ref in object.ref.all %}
                            {% include 'main/reference/reference-popup.html' %}<br>
                        {% endfor %}
                    </td>
                    {% endif %}
                  </tr>
                </tbody>
              </table>
            <br>
            <p>{{object.description}}</p>
        </div>
    </div>
    <div class="column">
        <div class="my-2">
            <h2>Timeline</h2>
            <div style="display:flex; gap:10px;">
              <a class="btn" href="{% url 'culture_detail' object.pk %}?nochildren=1">Show without Children</a>
              <a class="btn" href="{% url 'culture_detail' object.pk %}">Show with Children</a>
            </div>
            {% include 'main/timeline/timeline-body.html' %}
    </div>
        <script>
            var groups = {{timelinedata|safe}}
            var data= {{itemdata|safe}}
            data.forEach(element => {
                element.start = new Date(element.start);
                element.end = new Date(element.end);
            });
            var items = new vis.DataSet(data);
            var timeline = new vis.Timeline(container, items, groups, options);
        </script>
        <script src="{% static 'js/location.js' %}"></script>
        <script> drawJson({{geo | safe }}); fitBounds();</script>
        <script src="{% static 'js/site.js' %}"></script>
    </div>
</div>
{% endblock %}